---
description: Project context for new sessions
alwaysApply: true
---

# Content Engine

> Internal AI platform. Stores company knowledge in Weaviate, retrieves via semantic search, sends context + prompt to Claude for content generation.

## Stack

| Layer | Choice |
|---|---|
| Framework | Next.js 16, App Router, TypeScript |
| Styling | Tailwind CSS v4 |
| Vector DB | Weaviate Cloud (`weaviate-client` v3) |
| LLM | Anthropic Claude (`claude-opus-4-5`) via `lib/claude.ts` |
| Deploy | Vercel (pending) |

## Repo Structure

```
app/
  page.tsx                — Dashboard with connection status badges
  layout.tsx              — Root layout, Geist font
  api/chat/route.ts       — POST, streams Claude response
  api/knowledge/route.ts  — GET list, POST create
  api/knowledge/[id]/route.ts — GET detail, PUT update, DELETE, PATCH deprecate/restore
  api/dashboard/route.ts  — GET health metrics (counts, staleness, gaps)
  api/submissions/route.ts — GET list, POST create submissions
  api/submissions/[id]/route.ts — GET submission detail
  api/submissions/[id]/review/route.ts — POST accept/reject/defer
  api/submissions/[id]/merge/route.ts — POST stream AI merge
  api/submissions/[id]/merge/save/route.ts — POST save merged content
  knowledge/page.tsx      — Knowledge Base list page (filter tabs, search)
  knowledge/[id]/page.tsx — Knowledge Base detail page (markdown, sidebar, actions)
  knowledge/new/page.tsx  — Create form page
  knowledge/[id]/edit/page.tsx — Edit form page
  knowledge/components/   — KnowledgeList, KnowledgeForm, DetailActions, TypeBadge, MarkdownRenderer
  queue/page.tsx          — Review queue list page (filter tabs, show-closed toggle)
  queue/[id]/page.tsx     — Submission review page (preview, diff, actions)
  queue/components/       — SubmissionList, SubmissionReview, ContentDiff, MergeEditor
  components/             — RoleProvider, RoleToggle
  dashboard/page.tsx      — Health dashboard (stat cards, gap report, staleness, queue count)
  dashboard/components/   — StatCard, GapTable, StalenessList
lib/
  weaviate.ts             — withWeaviate<T>(fn), checkWeaviateConnection()
  claude.ts               — streamMessage(), checkClaudeConnection()
  knowledge.ts            — CRUD operations: list, get, create, update, delete, deprecate/restore
  knowledge-types.ts      — Client-safe types, input types, utilities
  dashboard.ts            — getDashboardData() health metrics aggregation
  submissions.ts          — Submission CRUD: create, list, get, review, countPending
  submission-types.ts     — Submission types, status enums, utilities
  merge.ts                — buildMergePrompt() for AI merge workflow
docs/
  PRD.md                  — Functional requirements and user stories
  TECH_DECISIONS.md       — Architecture decision records
  BUSINESS_LOGIC.md       — Context assembly, content types, skills vs rules, runtime logic
  KNOWLEDGE_BASE.md       — Weaviate schema (incl. Skill collection), content inventory, seed plan
  SCOPE.md                — Project overview, goals, status
  ROADMAP.md              — Phases, future modules, backlog, open questions
  CHANGELOG.md            — What was built and when
  API.md                  — API route contracts (incl. planned bulk upload, skills routes)
```

## Current Phase: 1

| Module | Status |
|---|---|
| Dashboard | Done |
| Knowledge Base (Read) | Done (Group A) |
| Knowledge Base (CRUD) | Done (Group B) |
| Knowledge Base (Relationships) | Done (Group C) |
| Knowledge Base (Health Dashboard) | Done (Group D) |
| Knowledge Base (Review Queue) | Done (Group E) |
| Knowledge Base (AI Merge) | Done (Group F) |
| Knowledge Base (Bulk Upload) | Scoped (Group G) |
| Knowledge Base (Enhanced Review) | Scoped (Group H) |
| Skills Module | Scoped (Group I) |
| Inbound MCP Server (3rd Party Write) | Scoped (Group J) |
| External REST API (3rd Party Read) | Scoped (Group K) |
| LLM MCP Server (RAG Read Access) | Scoped (Group L) |
| Generate (content creation) | Pending |
| Content Library | Future (Phase 2) |
| Workflows | Future (Phase 2) |

## Detail Pointers

- Weaviate schema, seed inventory, connection pattern: `docs/KNOWLEDGE_BASE.md`
- API contracts: `docs/API.md`
- Content types, context assembly, skills vs rules: `docs/BUSINESS_LOGIC.md`
- Tech decisions and rationale: `docs/TECH_DECISIONS.md`
- Full requirements and user stories: `docs/PRD.md`
- Future phases, backlog, open questions: `docs/ROADMAP.md`
